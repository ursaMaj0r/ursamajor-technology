<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8" />
    <link rel="stylesheet"href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/custom.css"><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P1CNC3J644"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P1CNC3J644');
</script><script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
</head><body class="drac-bg-black"><header>
<div style="float: left">
    <button class="drac-btn drac-bg-orange-red drac-m-xs drac-m-xxs custom-link-black"><a href="/">Home</a></button>
    <button class="drac-btn drac-bg-orange-red drac-m-xs drac-m-xxs custom-link-black"><a href="/about">About</a></button>
</div>
<div>
    <img src="/assets/images/static/logo.png" width="50vw" style="float: right;" /></div>
<div>
    <h2 class="drac-heading drac-text-orange" style="font-size: calc(10px + 1vw); text-align: right;">
        Ursa Major Technology
    </h2>
    <p class="drac-text drac-text-xs drac-text-right drac-text-orange-red">Bits, Blogging, and Beyond!</p>
</div>
</header>
<article itemscope itemtype="http://schema.org/BlogPosting">
  <div style="text-align:center;">
    
  </div>
  <div class=" custom-link-cyan drac-text drac-text-center"><div>
    <div>
        <h2 class="drac-heading drac-heading-md drac-text-orange drac-p-sm">
            PowerShell Port Scanner with Netcat
        </h2>
    </div>
    <div class="drac-text drac-text-md drac-text-white">
        Topics: <a href="/category/automation/" class="drac-text">Automation</a>, <a href="/category/cyber/" class="drac-text">Cyber</a>, <a href="/category/powershell/" class="drac-text">PowerShell</a>,  <a href="/category/scripts/" class="drac-text">Scripts</a></div>
</div></div>
  <div>
    <p class="drac-text drac-text-center drac-text-cyan"><time datetime="2021-10-04T21:00:00+00:00" itemprop="datePublished">
        Oct 4, 2021
      </time>
    </p>
  </div>
  <div class="drac-text drac-text-white drac-text-center center drac-text-sm custom-link-cyan" style="width:80%" itemprop="articleBody">
      <p>Yet another netcat port scanner…but with a twist of PowerShell.</p>

  </div>
  <div class="drac-text drac-text-white custom-link-cyan center drac-text-sm" style="width:80%" itemprop="articleBody">
      
<!--more-->

<h2 id="overview">Overview</h2>

<p>The below PowerShell Core script was created using netcat to scan a target host for a list of open ports. I chose to write the script in PowerShell Core because it can be run on any machine (not just Windows). The script works by iterating through a list of ports utilizing the zero I/O mode of netcat. Simply put, it attempts to open a connection on a specified TCP port with no data in the payload. This quickly can be used to determine if the port is open or closed and then is reported back to the user. In order to improve speed, I have chosen to set the timeout to one second using the w parameter.</p>

<h2 id="how-to-use">How to Use</h2>

<p>The script takes in the following parameters:</p>

<ol>
  <li><strong>Target</strong> - IP Address or FQDN of computer that will be scanned</li>
  <li><strong>PortRange</strong> - list of ports to scan (can be input as a single value, range, or list)</li>
  <li><strong>openOnly</strong>  - will only return the ports that were found to be open</li>
</ol>

<h2 id="examples">Examples</h2>

<p>For the purposes of the examples we will use google.com as the target. We will assume the target is a web server with ports 80 and 443 open (HTTP/HTTPS).</p>

<h3 id="example-1-single-port">Example 1: Single Port</h3>

<p>The following example can be used to determine if the server accepts HTTP traffic on port 80.</p>

<p><code class="language-plaintext highlighter-rouge">Start-PortScan -target google.com  -portRange 80</code></p>

<h3 id="example-2-range-of-ports">Example 2: Range of Ports</h3>

<p>The following example can be used to determine if the server has any open ports between 75 and 85.</p>

<p><code class="language-plaintext highlighter-rouge">Start-PortScan -target google.com -portRange (75..85)</code></p>

<p><br /><img src="/assets/images/posts/ps-nc-scanner/example.png" width="20%" /></p>

<h3 id="example-3-open-only">Example 3: Open Only</h3>

<p>The following example can be used to determine if the server has any open ports between 75 and 85. With the addition of the switch parameter, <em>openOnly</em>, the results will omit closed ports.</p>

<p><code class="language-plaintext highlighter-rouge">Start-PortScan -target google.com -portRange (75..85) -openOnly</code></p>

<h2 id="script">Script:</h2>
<script src="https://gist.github.com/ursaMaj0r/ba2b91e022f279fb80bc71b6d01295f3.js"></script>


  </div>
  <a href="/2021/10/04/ps-nc-scanner/" hidden></a>
</article>
</body><footer>
    <div class="custom-footer custom-link-cyan drac-text drac-text-xs drac-text-center drac-line-height drac-text-cyan drac-p-lg">
        <p>ursamajor.technology © 2021</p>
        <p>Powered by GitHub, <a href="https://www.buymeacoffee.com/ursamajor">Mary Lou's Coffee</a>, and <a href="https://github.com/ursaMaj0r/www-ursamajor-technology">Code</a>.
        </p>
    </div>
</footer></html>